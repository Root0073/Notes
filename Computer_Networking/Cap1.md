# Application of Internet
http: 在http中客户端打开与服务器的连接，并向其发送命令,以文档为中心
最常见的命令是get

BitTorrent:将文件分割成片段
这些协作的客户端被称为群集

**他们机制都是可靠的双向字节流**

但在BitTorrent中，客户端想要下载文件需要先找到一个成为种子文件的东西
他包含了想要下载数据文件的一切信息，包括追踪器是谁（追踪谁是群集的成员）
客户端之间动态交换数据的密集连截图

Skype:基于NAT.可以向外打开连接到互联网，但是互联网的其他节点不容易向你打开链接

# The Four Layer Internet Model
1. 链路层： 互联网由终端主机，链路和路由器构成

链路层的工作是一次将数据通过一条链路进行运输

2. 网络层：将数据包从源端到目的端，跨越整个互联网，进行端到端的传输

数据包：给那些带有头部信息的数据集合起的名字，网络层的数据包被称为数据报
他们由一些数据和一个包含发送和接收地址的头部组成

网络将数据报交给链路层，指示他通过第一条链路发送数据报，即链路层为网络层提供服务

在链路的另一端是一个路由器，路由器的链路层从链路接收数据报，并将其交给路由器内部的网络层

路由器上的网络层将检查数据报的目的地址，并负责将数据报一步一步地向起最终目的地路由，他通过再次将其发送给链路层使其通过下一条链路传输

网络层不需要关心链路层如何通过每条链路发送数据报

**网络层是特殊的：当我们向互联网发送数据报时，必须使用互联网协议（IP）**

IP会尽最大努力尝试将数据报送达另一段，但是他不做保证

IP数据报可能会丢失，他们可能会无序送达甚至损坏

3. 传输层：如果让数据在必要时能够重新传，并且按顺序无误地送达另一端，那么就要在ip之上运行另一个协议

最常见的协议是TCP，他的任务是确保互联网在一端发送的应用程序数据能够准确按顺序的送达互联网另一端的应用程序

如果应用程序不需要可靠的送达，那么他可以使用更简单的UDP，他完全不提供送达保证

4. 应用层：应用程序可以通过应用层到TCP或UDP服务的明确定义的API来复用传输层
## Summary
应用层： 通过一些特定的协议来进行两个应用程序之间的双向字节流

运输层： 保证数据端到端的正确有序传递，并控制堵塞

网络层： 负责端到端的数据报传递

链路层： 负责在终端主机和路由器之间或两个路由器之间通过单一链路传递数据

# The IP Service Model
IP数据报由头部和一些数据组成，当传输层由数据要发送时，他会将传输段交给下方的网络层，网络层将传输段放入他创建的新IP数据报中，IP的任务是将数据报送达网络的另一端

IP将数据报发送给链路层，链路层将其放入一个链路镇，然后将其发送到第一个路由器

IP服务的四个特性：
1. 不可靠

2. 是一种数据包服务 (数据报是自包含的)
头部包含目标的IP地址，我们成为IPDA， 所有的转发决策都基于这个IPDA
数据报头部还包含一个IP愿地址IPSA， 表明数据报的来源

3. IP承诺只在必要时会丢弃数据报

4. 无连接的
开始时不建立任何通信相关的端到端状态

IP试图防止数据报永远循环，在其头部加了一个计数器来统计经过的路由器数，如果超过了128则丢弃

如果数据报太长，IP会将其分片

IP使用头部校验来减少将数据报传输到错误目的地的可能性

IP允许在数据报头部增加新字段

IPv4是32字节，IPv6是128字节
IP头部中最重要的字段是目标IP地址，源IP地址和协议id（告诉我们数据字段中包含的内容）

## Why is the IP service so simple?
为了保持网络的简单，傻瓜化和最小化
IP对链路层做了非常少的假设，对其几乎没有期望

# A Day in the Life of a Packet

